"use strict";var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var myFullpage=function(){function e(t){_classCallCheck(this,e),this.container=document.querySelector(t),this.scrollByWheel=!0,this.timer=null,this.sectionsQuerrySelector=".section",this.sectionsList=[],this.currentSection=null,this._events={init:{callback:function(){}},changeSection:{callback:function(){}}},this.isWheelActive=!1,this.moveToIsActive=!1}return _createClass(e,[{key:"on",value:function(e,t){this._events[e]||(this._events[e]={}),this._events[e].callback=t}},{key:"removeListener",value:function(e,t){if(!this._events[e])throw new Error("Can't remove a listener. Event \""+e+"\" doesn't exits.");this._events[e]=this._events[e].filter((function(e){return e!==t}))}},{key:"emit",value:function(e,t){if(!this._events[e])throw new Error("Can't emit an event. Event \""+e+"\" doesn't exits.");this._events[e].callback(t)}},{key:"initSectionsList",value:function(){for(var e=document.querySelectorAll(this.sectionsQuerrySelector),t=0;t<e.length;t++){e[t].setAttribute("data-section-index",t)}return e}},{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.sectionsQuerrySelector,n=t.onInit,s=t.scrollByWheel;if(i&&(this.sectionsQuerrySelector=i),null!=s&&(this.scrollByWheel=s),n&&(this._events.init.callback=n),this.sectionsList=this.initSectionsList(),this.sectionsList.length){this.scrollByWheel&&window.addEventListener("wheel",(function(t){return e.handleWheel(t)}),{passive:!1}),this.setupScroll("on"),this.currentSection=this.getCurrentSection({fromLocalStorage:!0});var o=this.currentSection.dataset.sectionIndex;this.emit("init",{prevIndex:o,sectionsQuantity:this.sectionsList.length})}}},{key:"getCoords",value:function(e){return{top:e.getBoundingClientRect().top+pageYOffset}}},{key:"getCurrentSection",value:function(e){var t=this.sectionsList;if(e&&e.fromLocalStorage){for(var i=localStorage.getItem("full_page_active_index")||0,n=0;n<t.length;n++)if(t[n].dataset.sectionIndex==i)return t[n]}else for(var s=window.pageYOffset-1,o=0;o<t.length;o++)if(this.getCoords(t[o]).top>=s)return t[o];return t[t.length-1]}},{key:"setupScroll",value:function(e){var t=this;function i(e){t.handleScroll(e)}"on"==e?window.addEventListener("scroll",i,{passive:!0}):window.removeEventListener("scroll",i,{passive:!0})}},{key:"navigateByWheel",value:function(e){var t={};t.direction=e>0?-1:1,this.moveTo(t)}},{key:"moveTo",value:function(e){var t=this,i=e.direction,n=e.to;this.setupScroll("off"),this.moveToIsActive=!0,this.currentSection=this.getCurrentSection();var s=this.currentSection.dataset.sectionIndex,o=void 0,r=void 0;null!=n?o=this.sectionsList[+n]:(o=this.sectionsList[+s+i])||(i=i<0?i+1:i-1,o=this.sectionsList[+s+i]),o&&(r=o.dataset.sectionIndex,this.emit("changeSection",{prevIndex:s,nextIndex:r}),$("html, body").animate({scrollTop:$(o).offset().top+1},600,$.bez([.27,.74,.32,1])),setTimeout((function(){t.isWheelActive=!1,t.moveToIsActive=!1}),650))}},{key:"handleWheel",value:function(e){var t=this;if(e.preventDefault(),!this.isWheelActive){this.isWheelActive=!0;var i=e.wheelDeltaY;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.timer=null,t.navigateByWheel(i)}),100)}}},{key:"handleScroll",value:function(e){if(!this.isWheelActive&&!this.moveToIsActive){this.currentSection=this.getCurrentSection();var t=this.currentSection.dataset.sectionIndex;this.emit("scrollEvt",{prevIndex:t})}}}]),e}();