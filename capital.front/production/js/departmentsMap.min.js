"use strict";function CreateMap(e){this.map=null,this.mapDiv=document.getElementById(e),this.mapData=this.mapDiv.dataset,this.center={lat:Number(this.mapData.lat),lng:Number(this.mapData.lng)},this.initMap=function(e){e=e||8,this.map=new google.maps.Map(this.mapDiv,{center:this.center,zoom:e})}}function CreateMapDepartments(e,t){CreateMap.apply(this,arguments),t=t||[{lat:47.857599,lng:35.104645,title:"hey",description:"hey",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/lombard_metall_1.jpg",number:"№55"},{lat:47.858599,lng:35.124645,title:"fifafo",description:"fifafo",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/lombard_metall_2.jpg",number:"№143"},{lat:48.857599,lng:34.104645,title:"elo",description:"ole",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/lombard_metall_3.jpg",number:"№245"},{lat:49.857599,lng:36.104645,title:"raz",description:"raz",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/Gulyajpole-276x300.jpg",number:"№3"}];var o=[],r=null;this.panZoom=function(){this.map.panTo({lat:-25.363882,lng:131.044922})},this.setCluster=function(){var e=t.map(function(e,t){var a=new google.maps.Marker({position:{lat:e.lat,lng:e.lng},icon:"img/marker.png"}),n=new google.maps.InfoWindow({content:'\n                  <div class="lombard-map__image-wrapper">\n                    <img class="lombard-map__image" src="'+e.image+'">\n                  </div>\n                  <div class="lombard-map__number">'+e.number+'</div>\n                  <div class="lombard-map__location">'+e.address_ru+'</div>\n                  <div class="lombard-map__phone">\n                    <a href="tel:'+e.phone+'">'+e.phone+'</a>\n                  </div>\n                  <div class="lombard-map__description">'+e.description+'</div>\n                  <div class="lombard-map__work-time">'+e.time+'</div>\n                  <a href="'+e.link+'" class="lombard-map__link">'+e.more+"</a>\n                  \n                  ",width:350});o.push(n);var i=new google.maps.InfoWindow({content:"<div>"+e.number+"</div>"});return google.maps.event.addListener(a,"click",function(){for(var e=0;e<o.length;e++)o[e].close();i.close(),n.open(this.map,a),r=n,$(".lombard-map__image-wrapper").closest(".gm-style-iw").next().show()}),google.maps.event.addListener(a,"mouseover",function(){r||i.open(this.map,a)}),google.maps.event.addListener(a,"mouseout",function(){i.close()}),google.maps.event.addListener(n,"closeclick",function(){r=null}),a});new MarkerClusterer(this.map,e,{styles:[{url:"img/cluster-image.png",width:42,height:42,textColor:"#fff",textSize:12}]})}}function CreateMapDepartment(e){CreateMap.apply(this,arguments),this.setMarker=function(){new google.maps.Marker({position:this.center,map:this.map,icon:"img/marker.png"})}}var departmentsMap=void 0;function initMap(e){$("#departmentsMap").length&&((departmentsMap=new CreateMapDepartments("departmentsMap",e)).initMap(),departmentsMap.setCluster()),$("#departmentMap").length&&((e=new CreateMapDepartment("departmentMap")).initMap(),e.setMarker())}function locationZoom(e){departmentsMap.panZoom(e)}function loadLocations(){var t=new XMLHttpRequest;t.open("GET","/departments/get-departments/",!0),t.send(),t.onreadystatechange=function(){if(console.log("appa"),4==this.readyState)if(200!=this.status)console.log("ошибка: "+(this.status?this.statusText:"запрос не удался"));else{console.log(t.responseText);try{var e=JSON.parse(t.responseText);console.log(e)}catch(e){console.log("Некорректный ответ "+e.message)}initMap(e)}}}$(window).on("load",function(){$(".chosen-results").on("click",function(e){console.log(e.target),initMap(),locationZoom({lat:47.857599,lng:35.104645})});initMap([{lat:47.857599,lng:35.104645,title:"hey",description:"hey",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/lombard_metall_1.jpg",number:"№55"},{lat:47.858599,lng:35.124645,title:"fifafo",description:"fifafo",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/lombard_metall_2.jpg",number:"№143"},{lat:48.857599,lng:34.104645,title:"elo",description:"ole",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/lombard_metall_3.jpg",number:"№245"},{lat:49.857599,lng:36.104645,title:"raz",description:"raz",address_ru:"г. Запорожье, пр. Соборный,179",phone:"(067) 617-41-42",time:"Пн-Вс, 8:00-20:00",more:"Подробнее...",image:"img/Gulyajpole-276x300.jpg",number:"№3"}])});