"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};globalFunctions.getData=function(e,t,a){var o,l;o=e,l=a,axios.get(o,l).then(function(e){t(e)}).catch(function(e){console.log(e)})},globalFunctions.getLanguage=function(){return document.body.dataset.locale},globalVariables.messages={successResponse:"ru"===globalFunctions.getLanguage()?"Спасибо! ваша заявка принята!":"Дякуємо! Ваша заявка прийнята!",successDescr:"ru"===globalFunctions.getLanguage()?"Мы свяжемся с вами в ближайшее время.":"Ми зв'яжемося з вами найближчим часом.",errorResponse:"ru"===globalFunctions.getLanguage()?"Ошибка!":"Помилка!",errorResponseGadgets:"ru"===globalFunctions.getLanguage()?"Для просчета стоимости рекомендуем обратиться по адресу ближайшего отделения.":"Для розрахунку вартості радимо звернутись за адресою найближчого відділення.",errorDescr:"ru"===globalFunctions.getLanguage()?"Попробуйте еще раз":"спробуйте ще раз",errorDescr400:"ru"===globalFunctions.getLanguage()?"Превышена максимальная сумма":"Перевищено максимальну суму",yes:"ru"===globalFunctions.getLanguage()?"Да":"Так",no:"ru"===globalFunctions.getLanguage()?"Нет":"Нi",gold:(globalFunctions.getLanguage(),"Золото"),silver:"ru"===globalFunctions.getLanguage()?"Серебро":"Срiбло",isPhoto:"ru"===globalFunctions.getLanguage()?"Необходимо добавить фото изделия":"Необхідно завантажити фото виробу",transported_to:"ru"===globalFunctions.getLanguage()?"Перенесено в №":"Перенесено до №",find_nothing:"ru"===globalFunctions.getLanguage()?"Ничего не найдено!":"Нічого не знайдено!",work_time:"ru"===globalFunctions.getLanguage()?"Время работы":"Час роботи"},$(document).ready(function(){var a,s,t,o,l,r,n,i,c,u,g,d,p,m,f,h,b,v,y,k;function _(e){e=e instanceof jQuery?e[0]:e;e.reset(),$(e).find(".chosen-wrapper  select").trigger("chosen:updated"),$(e).is("#technics-form")&&(s=a=null,e.querySelector('.resultBlock .product-description input[name="price"]').value="",e.querySelector('.resultBlock .imgWrapper input[name="image"]').value="",function(e){var t=e instanceof jQuery?e[0]:e,a=void 0;if(globalVariables.myDropzone.length)for(var o=0;o<globalVariables.myDropzone.length;o++)if(globalVariables.myDropzone[o].element.id===t.id){a=globalVariables.myDropzone[o];break}return a}(document.getElementById("photoDropzoneGadgets")).removeAllFiles(!0))}function L(e){e=e instanceof jQuery?e[0]:e;e.querySelector(".no-result-block").classList.remove("active"),e.querySelector(".has-result-block").classList.add("active"),e.querySelector(".resultBlock").classList.add("hasResult")}function S(e){e=e instanceof jQuery?e[0]:e;e.querySelector(".no-result-block").classList.add("active"),e.querySelector(".has-result-block").classList.remove("active"),e.querySelector(".resultBlock").classList.remove("hasResult")}function q(t,c,e,f,a){function o(e,m){var t,a,o=e.data.overPayment.toFixed(2),l=e.data.amount.toFixed(2),r=$(m+" .overPayment-js"),n=$(m+" .amount-js"),e=$(m+" .amount-discount-js"),s=$(m+" .js_setTariff"),i=$(c+" .chosen-single span").text();r.text(o+" грн"),n.text(l+" грн"),e.text((o-20*o/100).toFixed(2)+" грн"),function(){for(var e=$("#3 option"),t=0;t<e.length;t++)if($(e[t]).text()==i){var a=$(e[t]).data("tariff");if(a)return s.text('"'+a+'"')}s.text('"'+i+'"')}(),t=m,a=$(t+" .has-result-block .graph-item:nth(1)"),t=$(t+" .has-result-block .graph-item:nth(2)"),a.removeClass("disabled"),t.hide(),$(m+" .calcModal").on("click",function(e){e.preventDefault();var e=document.querySelector("#popupRequest .submitButtonWrapper button[type=submit]"),s=$(".resWeight-js"),i=$(".resHall-js"),c=$(".resStones-js"),u=$(".resTariff-js"),g=$(".resDays-js"),d=$(".resOverPayment-js"),p=$(".resAmount-js");s.text($(m+" input[name=weight]").val()),i.text($(m+" select[name=hallmark]").val()),c.text($(m+" input[name=additions]:checked").hasClass("yes")?globalVariables.messages.yes:globalVariables.messages.no),u.text($(m+" select[name=tariff]").val()),g.text($(m+" .slider-range").slider("value")),d.text(o+" грн"),p.text(l+" грн");var a=$("#404m");F(function(e){var t=e.data,e="ru"===globalFunctions.getLanguage()?"title_ru":"title_uk";M(t,a,e)})("/calculator/get-cities"),e.onclick=function(e){e.preventDefault();var t=$(this).closest($(".calculate-form"));if(!ValidationModule.isValid(t))return!1;var a=$("#401m"),o=$("#402m"),l=$("#403m"),r=$("#404m_chosen .chosen-single span"),e=$("#popupRequest input[name^=files]"),t="#gold-form"==m?globalVariables.messages.gold:globalVariables.messages.silver,n={weight:Number(s.text()),hallmark:Number(i.text()),stone:c.text()==globalVariables.messages.yes?1:0,tariff:u.text(),term:Number(g.text()),overpayment:Number(d.text().replace(/\s?[а-я]/gi,"")),amount:Number(p.text().replace(/\s?[а-я]/gi,"")),name:a.val(),phone:o.val(),email:l.val(),city:r.text(),client_status:$(f+" .chosen-single span").text(),category:t};e.val()&&(n.files=e.val()),axios({method:"post",url:"/calculator/requests",data:n}).then(function(e){var t;(t=document.getElementById("popupMessage")).querySelector(".title").innerHTML=globalVariables.messages.successResponse,t.querySelector(".description > p").innerHTML=globalVariables.messages.successDescr,PopupModule.openPopup(t),dataLayer&&(console.log("in handleGoldAndSilverFormsStatistic: category",n.category),"Золото"==n.category?dataLayer.push({event:"calculate_zoloto"}):dataLayer.push({event:"calculate_silver"})),PopupModule.closePopup(document.getElementById("popupRequest"))}).catch(function(e){h(),console.log(e)})}})}function l(e,t){for(var a=$(e+" .chosen-single span").text(),o=$(t+" option"),l=[],r=0;r<o.length;r++)l[r]=$(o[r]).text();a=l.indexOf(a);return"#3_chosen"==e||"#35_chosen"==e||"#4_chosen"==e||"#36_chosen"==e?$(o[a]).data("id"):void 0}function h(e){var t=document.getElementById("popupMessage");t.querySelector(".title").innerHTML=globalVariables.messages.errorResponse,t.querySelector(".description > p").innerHTML=globalVariables.messages.errorDescr;400===e&&(t.querySelector(".description > p").innerHTML=globalVariables.messages.errorDescr400),PopupModule.openPopup(t)}ValidationModule.isValid($(t))&&(e=l(c,e)||$(e+" option:selected").data("id"),a=l(f,a)||$(a+" option:selected").data("id"),a={weight:$(t+" input[name=weight]").val(),hallmark:$(t+" select[name=hallmark]").val(),tariff:e,status:a,days:$(t+" .slider-range").slider("value")},axios.get("/calculator/calculate",{params:a}).then(function(e){L($(t)),o(e,t)}).catch(function(e){h(e.response.status)}))}function x(e,t,a){axios.defaults.headers.common["X-CSRF-TOKEN"]=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),axios({method:"post",url:e,data:t}).then(function(e){200==e.status&&a(e)}).catch(function(e){console.error(e),a(e)})}function B(){$(".js_block_toggle").toggleClass("active")}function M(e,a,o){if(a.empty(),a.append('<option value="placeholder" style="display:none">'+a.data("placeholder")+"</option>"),"string"==typeof e[0])for(var t=0;t<e.length;t++)a.append("<option>"+e[t]+"</option>");else e.map(function(e){var t;e.id?e.related_tariff?(t="ru"==$("body").data("locale")?"title_ru":"title_uk",t=e.related_tariff[t].replace(/"/g,""),a.append('<option data-tariff="'+t+'" data-id="'+e.id+'">'+e[o]+"</option>")):a.append('<option data-id="'+e.id+'">'+e[o]+"</option>"):a.append("<option>"+e[o]+"</option>")});a.trigger("chosen:updated")}function F(a){return function(e,t){axios.get(e,t).then(function(e){a(e)}).catch(function(e){console.log(e)})}}function T(e,a,o){e.chosen().change(function(e,t){a.prop("disabled",!1).trigger("chosen:updated"),o("/calculator/get-tariffs",{params:{hallmark:""+(this[this.selectedIndex].value||t.selected)}})})}function V(u,g,d,p,m,f){u.chosen().change(function(e,t){var a=this,o=g.filter(function(e){return window.innerWidth<768?e.calc_category_id==m&&e[d]==$(a).val():e.calc_category_id==m&&e[d]==t.selected}),l=void 0,l=o[0].terms[o[0].terms.length-1].to;p.slider("option",{disabled:!1,max:l,value:1});var r,n,s,i,c,l=p.slider("value");p.find(".text").text(l),r=d,n=m,s=t,i=f,c=u,l=(l=g).filter(function(e){if(window.innerWidth<768){var t=c.val();return e.calc_category_id==n&&e[r]==t}return e.calc_category_id==n&&e[r]==s.selected}),i.empty(),l[0].statuses.map(function(e){i.append('<option data-id="'+e.id+'">'+e[r]+"</option>")}),i.prop("disabled",!1).trigger("chosen:updated")})}function w(a,e,o,l){if(a.empty(),a.append('<option value="placeholder" style="display:none">'+a.data("placeholder")+"</option>"),e){if(Array.isArray(e)&&"object"!=_typeof(e[0]))for(var t=0;t<e.length;t++)a.append("<option>"+e[t]+"</option>");else"object"===_typeof(e[0])&&e.map(function(e){var t=document.createElement("option");t.setAttribute("data-id",e.id||"none"),t.innerHTML=l?e[o]+" ("+e[l]+")":e[o],a.append($(t))});a.trigger("chosen:updated")}}($("#calculatorPage").length||$("#specialPage").length)&&(t=$("#2"),o=$("#32"),l=$("#3"),$("#3_chosen"),r=$("#4"),n=$("#35"),$("#35_chosen"),i=$("#36"),c=$("#gold-tab .slider-range"),u=$("#silver-tab .slider-range"),g=!1,$("#startBlock").on("click",".seriesTab",function(){var e,t=$(this).closest("form");_(t),(e=(e=t)instanceof jQuery?e[0]:e).querySelector(".resultBlock .product-description .name").innerHTML="",e.querySelector(".resultBlock .product-description .price").innerHTML="",$(e).find(".resultBlock .imgWrapper > img").hide(),e.querySelector(".resultBlock .condition > p").innerHTML="",e.querySelector(".resultBlock .set > p").innerHTML="",S(t)}),$("body").on("click",".hideResult",function(){S($(this).closest("form"))}),$(".calculate-form").on("submit",function(){return!1}),$(".calculate-form").on("click",".submitButton",function(e){e.preventDefault();var l,r,t,a,o,n=this.form;$(this).closest(".calculate-form").is("#gold-form")?q("#gold-form","#3_chosen","#3","#4_chosen","#4"):$(this).closest(".calculate-form").is("#silver-form")?q("#silver-form","#35_chosen","#35","#36_chosen","#36"):$(this).closest(".calculate-form").is("#technics-form")&&(o=function(a,o){return function(e){var t=Math.floor(e.data);a.querySelector(".resultBlock .product-description .name").innerHTML=s.model,a.querySelector('.resultBlock .product-description input[name="price"]').value=t,a.querySelector('.resultBlock .imgWrapper input[name="image"]').value=s.image,$(".request-answer").addClass("flex"),e=s,t=a,(t=$(t)).find(".resultBlock .imgWrapper > img").show(),e.image?t.find(".resultBlock .imgWrapper > img").attr("src",e.image):t.find(".resultBlock .imgWrapper > img").hide(),SwitchTabsModule.switchSeriesTabs(o,r,globalVariables.currentGroup),globalFunctions.animateBlock(l)}},t=n.querySelector('input[name="condition"]:checked'),a=n.querySelector('input[name="set"]:checked'),n.querySelector(".resultBlock .condition > p").innerHTML=t.value,n.querySelector(".resultBlock .set > p").innerHTML=a.value,l=document.getElementsByClassName("subToggleBlocks-list")[0],r=document.querySelectorAll(".subToggleBlocks-list > .toggleBlock"),(e=$("#technics-tab .photoDropzone .dz-image img").attr("src"))&&(n.querySelector(".resultBlock .imgWrapper > img").src=e,$(n).find(".resultBlock .imgWrapper > img").show()),s?(t=t.dataset.multiplier,a=a.dataset.multiplier,a="/calculator/correct-price/"+s.price+"/"+t+"/"+a,globalFunctions.getData(a,o(this.form,this))):(o=[],$("#101").val()&&o.push($("#101").val()),$("#102").val()&&o.push($("#102").val()),$("#103").val()&&o.push($("#103").val()),$("#106").val()&&o.push($("#106").val()),$("#107").val()&&o.push($("#107").val()),$("#108").val()&&o.push($("#108").val()),$("#109").val()&&o.push($("#109").val()),o=o.join(", "),n.querySelector(".resultBlock .product-description .name").innerHTML=o,$(".request-answer").removeClass("flex"),L(n),SwitchTabsModule.switchSeriesTabs(this,r,globalVariables.currentGroup),globalFunctions.animateBlock(l)))}),$(".calculate-form").on("click",".submitFormButton",function(){var e,t,a,o,l,r,n,s=$(this).closest(".toggleBlock");ValidationModule.isValid(s)&&(s=function(e){var t=e.querySelectorAll("input:not([type=radio])"),a=e.querySelectorAll("input[type=radio]"),o=e.querySelectorAll("select"),l=e.querySelectorAll("textarea"),r={};if(t.length)for(var n=0;n<t.length;n++)t[n].value&&(r[t[n].name]=t[n].value);if(a.length)for(var s=0;s<a.length;s++){var i=a[s];i.value&&i.checked&&(r[i.name]=i.value)}if(o.length)for(var c=0;c<o.length;c++)o[c].value&&"placeholder"!=o[c].value&&(r[o[c].name]=o[c].value);if(l.length)for(var u=0;u<l.length;u++)l[u].value&&(r[l[u].name]=l[u].value);return r}(e=this.form),"technics-form"===e.id?(t=function(){dataLayer&&(console.log("in handleGadgetsStatistic"),dataLayer.push({event:"calculate_technique"}))},a=function(){var e=document.getElementById("popupMessage");e.querySelector(".title").innerHTML=globalVariables.messages.errorResponseGadgets;PopupModule.openPopup(e)},$(".toggleBlock.active .prevButton, .toggleBlock.active .seriesTab").on("click",function(){g&&(B(),g=!1),$(".toggleBlock.active .prevButton, .toggleBlock.active .seriesTab").off("click")}),x("/calculator/gadgets-requests",s,(n=e,function(e){$(".request-answer").show(),200==e.status?t():e.response&&400==e.response.status?($(".request-answer").hide(),a()):e.response&&e.response.status&&$(".request-answer__text").text(globalVariables.messages.errorResponseGadgets),g=!0,B(),L(n)}))):e.classList.contains("special_ability_form")&&(o=function(e){if(dataLayer)switch(console.log("in handleDiamondsAntiquesClocksJewelryStatistic type:",e.type),e.type){case"diamond":dataLayer.push({event:"calculate_diamond"});break;case"antiques":dataLayer.push({event:"calculate_antiques"});break;case"watch":dataLayer.push({event:"calculate_clock"});break;case"jewelry":dataLayer.push({event:"calculate_jewerly"})}},x("/calculator/special-abilities",s,(l=e,r=s,function(e){var t=document.getElementById("popupMessage");200==e.status?(t.querySelector(".title").innerHTML=globalVariables.messages.successResponse,t.querySelector(".description > p").innerHTML=globalVariables.messages.successDescr,_(l),o(r)):(t.querySelector(".title").innerHTML=globalVariables.messages.errorResponse,t.querySelector(".description > p").innerHTML=globalVariables.messages.errorDescr),PopupModule.openPopup(t)}))))}),F(function(e){M(e.data,t,"hallmark"),T(t,l,d)})("/calculator/get-hallmarks",{params:{category:"1"}}),F(function(e){M(e.data,o,"hallmark"),T(o,n,p)})("/calculator/get-hallmarks",{params:{category:"2"}}),d=F(function(e){var t=e.data.filter(function(e){return 1==e.calc_category_id}),a="ru"==$("body").data("locale")?"title_ru":"title_uk";M(t,l,a),V(l,e.data,a,c,1,r)}),l.prop("disabled",!0).trigger("chosen:updated"),p=F(function(e){var t=e.data.filter(function(e){return 2==e.calc_category_id}),a="ru"==$("body").data("locale")?"title_ru":"title_uk";M(t,n,a),V(n,e.data,a,u,2,i)}),n.prop("disabled",!0).trigger("chosen:updated")),($("#calculatorPage").length||$("#specialPage").length)&&($("#calculatorPage").length&&(m=function(e){a=e.data.models,w(b,e.data.models,"model"),b.prop("disabled",!1).trigger("chosen:updated")},f=function(e){var t="ru"===globalFunctions.getLanguage()?"meta_title_ru":"meta_title_uk",a="ru"===globalFunctions.getLanguage()?"address_ru":"address_uk";e.data.length&&(w(y,e.data,t,a),y.prop("disabled",!1).trigger("chosen:updated"))},h=$("#311"),b=$("#312"),v=$("#404"),y=$("#405"),globalFunctions.getData("/calculator/get-brands",function(e){w(h,e.data.brands)}),b.prop("disabled",!0).trigger("chosen:updated"),h.chosen().change(function(e,t){t={brand:this[this.selectedIndex].value||t.selected};globalFunctions.getData("/calculator/get-models",m,{params:t})}),b.chosen().change(function(e,t){s=function(e,t,a){var o=null;if(e)for(var l=0;l<e.length;l++)if(e[l][a]==t){o=e[l];break}return o}(a,this[this.selectedIndex].value,"model")}),globalFunctions.getData("/calculator/get-cities",function(e){var t="ru"===globalFunctions.getLanguage()?"title_ru":"title_uk";w(v,e.data,t)}),y.prop("disabled",!0).trigger("chosen:updated"),v.chosen().change(function(e,t){t=function(e,t){var a=void 0;if(e){var o=e.children;if(o)for(var l=0;l<o.length;l++)if(o[l].innerHTML===t){a=o[l].dataset.id;break}}return a}(e.target,this[this.selectedIndex].value||t.selected);t&&globalFunctions.getData("/calculator/get-departments/"+t,f)})),$("#specialPage").length&&(k=$("#301"),globalFunctions.getData("/calculator/get-watches",function(e){w(k,e.data,"brand")})))});